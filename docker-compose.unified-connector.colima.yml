version: "3.8"

services:
  unified_connector:
    build:
      context: .
      dockerfile: unified_connector/Dockerfile
    image: unified-connector:local
    container_name: unified-connector
    ports:
      - "8080:8080"   # Web UI
      - "8081:8081"   # Health
      - "9090:9090"   # Prometheus (optional)
    environment:
      - PYTHONUNBUFFERED=1
      - CONNECTOR_LOG_LEVEL=INFO
      # Recommended (enables encrypted credential storage)
      - CONNECTOR_MASTER_PASSWORD=${CONNECTOR_MASTER_PASSWORD:-changeme123}
    volumes:
      # Persist connector data/spool
      - connector_data:/data
      # Persist credentials inside container home
      - connector_credentials:/home/connector/.unified_connector
      # Mount config so you can edit locally
      - ./unified_connector/config:/app/unified_connector/config
    restart: unless-stopped

volumes:
  connector_data:
  connector_credentials:

