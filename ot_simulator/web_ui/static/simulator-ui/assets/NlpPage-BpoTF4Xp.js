import{u as g,r as c,j as e,P as d,B as o,T as m,F as b}from"./index-D7osG2pV.js";import{u as h}from"./useSimulatorWs-BS671Sgl.js";function k(){const n=g(),s=h(),[a,i]=c.useState(""),[r,u]=c.useState(""),x=c.useMemo(()=>s.nlpLog.slice(-100).map(t=>`${new Date(t.ts).toLocaleTimeString()} ${t.direction==="out"?">>":"<<"} ${JSON.stringify(t.payload)}`).join(`
`),[s.nlpLog]);return e.jsxs("div",{style:{display:"grid",gap:16},children:[e.jsx(d,{title:"NLP / WebSocket",subtitle:"Live status + start/stop + chat commands",children:e.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("span",{className:"muted",children:"Connection:"}),e.jsx("span",{style:{fontFamily:"var(--font-data)"},children:s.connected?"connected":"disconnected"}),e.jsx(o,{type:"button",onClick:()=>s.getStatus(),disabled:!s.connected,children:"Get status"})]})}),e.jsxs(d,{title:"Chat / commands",subtitle:'Sends { type: "nlp_command" } over /ws',children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 140px",gap:10},children:[e.jsx(m,{value:a,onChange:t=>i(t.target.value),placeholder:'Examples: "start opcua", "stop mqtt", "status"',onKeyDown:t=>{t.key==="Enter"&&(s.sendNlpCommand(a.trim())||n.show("WebSocket not connected","warn"),i(""))}}),e.jsx(o,{variant:"primary",type:"button",onClick:()=>{s.sendNlpCommand(a.trim())||n.show("WebSocket not connected","warn"),i("")},disabled:!s.connected,children:"Send"})]}),e.jsx("pre",{className:"kvs",style:{marginTop:10,marginBottom:0,maxHeight:360},children:e.jsx("code",{style:{color:"var(--text-primary)"},children:x||"No messages yet."})})]}),e.jsxs(d,{title:"Sensor subscriptions",subtitle:"Subscribe/unsubscribe to sensor paths",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 140px 140px",gap:10,alignItems:"end"},children:[e.jsx(b,{label:"Sensors (comma-separated)",children:e.jsx(m,{value:r,onChange:t=>u(t.target.value),placeholder:"mining.crusher.bearing_temp, ..."})}),e.jsx(o,{type:"button",onClick:()=>{const t=r.split(",").map(l=>l.trim()).filter(Boolean);s.subscribe(t)||n.show("WebSocket not connected","warn")},disabled:!s.connected,children:"Subscribe"}),e.jsx(o,{variant:"danger",type:"button",onClick:()=>{const t=r.split(",").map(l=>l.trim()).filter(Boolean);s.unsubscribe(t)||n.show("WebSocket not connected","warn")},disabled:!s.connected,children:"Unsubscribe"})]}),e.jsx("div",{className:"muted",style:{marginTop:10},children:"Latest sensor_data payload (raw):"}),e.jsx("pre",{className:"kvs",style:{marginTop:8,marginBottom:0,maxHeight:280},children:e.jsx("code",{style:{color:"var(--text-primary)"},children:JSON.stringify(s.sensorData,null,2)})})]})]})}export{k as NlpPage};
