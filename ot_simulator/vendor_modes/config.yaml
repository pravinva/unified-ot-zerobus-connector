# Vendor Mode Configuration for OT Simulator
#
# This file configures vendor-specific output formats for the simulator.
# Multiple modes can be enabled simultaneously.

vendor_modes:
  # Generic mode - Simple JSON/OPC UA format (always available)
  generic:
    enabled: true
    opcua_enabled: true
    opcua_port: 4840  # Default OPC UA port
    mqtt_enabled: true
    mqtt_topic_prefix: "sensors"

  # Kepware KEPServerEX mode - Channel.Device.Tag structure
  kepware:
    enabled: true
    opcua_enabled: true
    opcua_port: 49320  # Typical Kepware OPC UA port
    mqtt_enabled: true
    mqtt_topic_prefix: "kepware"

    settings:
      iot_gateway_format: true  # Use Kepware IoT Gateway JSON format
      batch_by_device: true  # Batch multiple tags per device

      # Channel mappings (optional - auto-generated if not specified)
      channel_mappings:
        channels:
          - name: "Siemens_S7_Crushing"
            driver_type: "Siemens TCP/IP Ethernet"
            plc_vendor: "siemens"
            plc_model: "S7-1500"
            devices:
              - name: "Crusher_01"
                sensors: []  # Auto-populated from sensor registrations
              - name: "Crusher_02"
                sensors: []

          - name: "Modbus_TCP_Fleet"
            driver_type: "Modbus TCP/IP"
            plc_vendor: "generic"
            plc_model: "Generic"
            devices:
              - name: "Haul_Truck_Fleet"
                sensors: []

          - name: "AB_ControlLogix_Utilities"
            driver_type: "Allen-Bradley ControlLogix Ethernet"
            plc_vendor: "rockwell"
            plc_model: "ControlLogix 5580"
            devices:
              - name: "Power_Substation"
                sensors: []

  # Sparkplug B mode - Eclipse IoT standard
  sparkplug_b:
    enabled: true
    opcua_enabled: false  # Sparkplug B is MQTT-only
    mqtt_enabled: true
    mqtt_topic_prefix: "spBv1.0"  # Sparkplug B namespace

    settings:
      group_id: "DatabricksDemo"
      edge_node_id: "OTSimulator01"
      use_protobuf: false  # Use JSON for now (Protobuf optional)
      cov_threshold: 0.01  # 1% change threshold for publishing (efficiency)

      # Device mappings (optional - auto-generated by industry)
      device_mappings:
        MiningAssets:
          industries: ["mining"]
        PowerGrid:
          industries: ["utilities"]
        ProductionLine:
          industries: ["manufacturing"]
        PipelineMonitor:
          industries: ["oil_gas"]

  # Honeywell Experion PKS mode - Composite points
  honeywell:
    enabled: false  # Disabled by default (enable when needed)
    opcua_enabled: true
    opcua_port: 4897  # Separate OPC UA server for Experion
    mqtt_enabled: true
    mqtt_topic_prefix: "honeywell"

    settings:
      server_name: "MINE_A_EXPERION_PKS"
      pks_version: "R520"

      # Module configuration (optional - auto-generated if not specified)
      modules:
        FIM_01:
          type: "FIM"  # Field I/O Module
        ACE_01:
          type: "ACE"  # Advanced Control Environment (controllers)
        LCN_01:
          type: "LCN"  # Local Control Network (SCADA)

# Global settings for all modes
global:
  # Automatically register sensors with all enabled modes
  auto_register: true

  # Quality code mapping consistency across modes
  consistent_quality: true

  # Logging
  log_level: "INFO"
  log_mode_switches: true
