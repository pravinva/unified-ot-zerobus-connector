connector:
  name: Unified OT Zerobus Connector Client
  log_level: INFO
  log_file: unified_connector.log
bridge:
  autostart: true
web_ui:
  enabled: true
  host: 0.0.0.0
  port: 8082
  auto_open_browser: false
  # NIS2 Compliance: Authentication & Authorization (Article 21.2(g))
  authentication:
    enabled: true
    method: oauth2
    require_mfa: true
    oauth:
      # Supported providers: azure, okta, google
      provider: azure
      client_id: ${env:OAUTH_CLIENT_ID}
      client_secret: ${env:OAUTH_CLIENT_SECRET}
      tenant_id: ${env:OAUTH_TENANT_ID}
      redirect_uri: ${env:OAUTH_REDIRECT_URI:http://localhost:8082/login/callback}  # Change to https:// when TLS enabled
      scopes:
      - openid
      - email
      - profile
    session:
      secret_key: ${env:SESSION_SECRET_KEY}
      max_age_seconds: 28800  # 8 hours
      cookie_name: unified_connector_session
      secure: false  # Set to true in production with HTTPS
      httponly: true
      samesite: lax
    rbac:
      enabled: true
      # Role definitions (built-in)
      roles:
        admin:
          permissions:
          - read
          - write
          - configure
          - manage_users
          - start_stop
          - delete
        operator:
          permissions:
          - read
          - write
          - start_stop
        viewer:
          permissions:
          - read
      # Map OAuth groups to roles
      role_mappings:
        "OT-Admins": admin
        "OT-Operators": operator
        "OT-Viewers": viewer
      # Default role for authenticated users with no group match
      default_role: viewer
  # NIS2 Compliance: TLS/SSL (Article 21.2(h) - Encryption in transit)
  tls:
    enabled: false  # Set to true to enable HTTPS
    # Certificate options:
    # 1. Auto-generate self-signed (for development)
    # 2. Provide custom certificate paths (for production)
    common_name: localhost
    san_list:  # Subject Alternative Names (DNS names and IP addresses)
      - localhost
      - 127.0.0.1
      - ::1
      # Add your server hostname/IP:
      # - unified-connector.example.com
      # - 192.168.1.100
    # Custom certificate paths (leave empty for auto-generated)
    cert_file: ""  # Path to certificate file (e.g., /path/to/server.crt)
    key_file: ""   # Path to private key file (e.g., /path/to/server.key)
    # HSTS (HTTP Strict Transport Security) settings
    hsts:
      max_age: 31536000  # 1 year in seconds
      include_subdomains: true
      preload: false  # Set to true only if you want to be in HSTS preload list
    # Client certificate authentication (mutual TLS)
    require_client_cert: false
discovery:
  enabled: true
  network:
    scan_enabled: true
    scan_interval_sec: 300
    subnets:
    - 127.0.0.1/32
    - 192.168.20.0/24
  opcua:
    enabled: true
    default_port: 4841
    timeout_sec: 5.0
  mqtt:
    enabled: true
    default_port: 1883
    default_tls_port: 8883
    timeout_sec: 3.0
  modbus:
    enabled: true
    default_tcp_port: 502
    alt_tcp_port: 5020
    timeout_sec: 2.0
sources:
- name: ot-simulator-opcua
  protocol: opcua
  endpoint: opc.tcp://127.0.0.1:4841
  enabled: true
  security_mode: None
  normalization_enabled: false
  polling_mode: true
  polling_interval_ms: 1000
  subscription_mode: false
- name: modbus-127-0-0-1-5020
  protocol: modbus
  endpoint: modbus://127.0.0.1:5020
  enabled: true
- name: mqtt-127-0-0-1-1883
  protocol: mqtt
  endpoint: mqtt://127.0.0.1:1883
  enabled: true
- name: opcua-127-0-0-1-4841
  protocol: opcua
  endpoint: opc.tcp://127.0.0.1:4841/ot-simulator/server/
  enabled: true
normalization:
  enabled: true
  path_template: '{site}/{area}/{line}/{equipment}/{signal_type}/{tag_name}'
  default_context:
    site: plant1
    area: production
    line: line1
    equipment: default
  quality_mapping:
    opcua:
      good:
      - 0
      uncertain:
      - 64
      - 65
      - 66
      bad:
      - 128
      - 129
      - 130
    mqtt:
      good:
      - online
      - connected
      bad:
      - offline
      - disconnected
    modbus:
      good:
      - 0
      bad:
      - 1
      - 2
      - 3
      - 4
zerobus:
  enabled: true
  workspace_host: https://e2-demo-field-eng.cloud.databricks.com
  zerobus_endpoint: 1444828305810485.zerobus.us-west-2.cloud.databricks.com
  default_target:
    workspace_host: https://e2-demo-field-eng.cloud.databricks.com
    catalog: opcua
    schema: scada_data
    table: opcua_events_bronze
  auth:
    client_id: ${credential:zerobus.client_id}
    client_secret: ${credential:zerobus.client_secret}
  batch:
    max_records: 1000
    timeout_seconds: 5.0
  source_targets: {}
  proxy:
    enabled: false
    http_proxy: ""
    https_proxy: ""
    # no_proxy: Bypass proxy for these hosts (OT devices on local network)
    # Include localhost AND your OT network CIDR ranges
    # Common OT networks: 192.168.0.0/16 (Class C), 10.0.0.0/8 (Class A), 172.16.0.0/12 (Class B)
    no_proxy: "localhost,127.0.0.1,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12"
    use_env_vars: true
backpressure:
  max_queue_size: 50000
  drop_policy: oldest
  disk_spool:
    enabled: true
    directory: ./spool
    max_size_mb: 500
    compression: gzip
credentials:
  storage:
    type: encrypted
    file: ~/.unified_connector/credentials.enc
monitoring:
  health_check:
    enabled: true
    port: 8081
  prometheus:
    enabled: true
    port: 9090
    path: /metrics
  stats:
    enabled: true
    update_interval_seconds: 10
performance:
  max_concurrent_connections: 100
  connection_pool_size: 20
  read_buffer_size: 8192
  write_buffer_size: 8192
